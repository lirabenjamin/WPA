nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+geom_point()+facet_wrap(~Variable,scales = "free_y")+
theme_ang()
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+geom_point()+facet_wrap(~Variable,scales = "free_y")+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+geom_point()+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+geom_point()+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+geom_point()+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
?stat_summary
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.data = "mean")
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.data = "mean")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.data = "mean",geom = "point")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.data = "mean",geom = "point",y = Value)+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",y = Value)+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",shape = "-")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",shape = "-",size = 10)+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 20) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 10) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun.y = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 10) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
for(i in 1:10){
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
ggsave(paste("Plots/ICC/",i,".pdf"))
}
for(i in 1:10){
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
ggsave(paste("Plots/ICC/",i,".pdf"))
}
for(i in 1:10){
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
ggsave(paste0("Plots/ICC/",i,".pdf"),width = 10,height = 5)
}
system("convert -delay 80 Plots/ICC/*.pdf example_1.gif")
system("convert -delay 80 Plots/ICC/*.pdf example_1.gif")
system("convert -delay 180 -density 500 Plots/ICC/*.pdf example_1.gif")
iccsp %>% unnest(iccs)
iccs
iccs %>% mutate(icc = 1 - icc)
iccs %>% mutate(ICC = 1 - ICC)
right_join(iccsp %>% unnest(iccs),
iccs %>% mutate(ICC = 1 - ICC))
iccsp
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC))
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
iccsp %>% select(year,Outcome,ICC1,ICC1k)
iccsp
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k)
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),numformat(ICC1k)))
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")")))
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,ICC)
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc)
# Comparing manual vs. psych()
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
write.clip
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %T>%
write.clip
sc$Relationship
sc$Relationship %>% unique()
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
filter(Relationship == "Manager") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
filter(Relationship == "DirectReport") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
# Comparing manual vs. psych()
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank(),panel.grid.major.x = element_line())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank(),panel.grid.major.x = element_line(colour = "gray",size = .1))
for(i in 1:10){
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
nest() %>%
ungroup() %>%
slice_sample(n = 15) %>%
unnest(data) %>%
gather(Variable,Value,-SubjectID) %>%
ggplot(aes(SubjectID,Value))+
geom_point(alpha = .3)+
stat_summary(fun = "mean",geom = "point",shape = "-",size = 10,col= "Red")+
facet_wrap(~Variable,scales = "free_y",nrow = 2)+
theme_ang()+
theme(axis.text.x = element_blank(),panel.grid.major.x = element_line(colour = "gray",size = .1))
ggsave(paste0("Plots/ICC/",i,".pdf"),width = 10,height = 5)
}
system("convert -delay 180 -density 500 Plots/ICC/*.pdf example_1.gif")
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %T>%
write.clip
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %T>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ")
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ")
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1","ICC1k"),sep = " ")
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ")
