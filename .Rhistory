select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ")
iccsp
iccsp$iccs
iccsp$data
iccsp$data[[1]]
iccsp$data[[1]] %>% ICC
iccsp$data[[1]] %>% head
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n())
iccsp
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>%
group_by(Outcome,year)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
iccsp$data[[2]] %>% head
iccsp
iccsp %>%
unnest(iccs)
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ")
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T%
write.clip
library(magritts)
library(magrittr)
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T%
write.clip
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip
iccsp$data
iccsp$data[[1]] %>% head
iccsp$data[[2]] %>% head
iccsp$data[[3]] %>% head
iccsp$data[[1]] %>% head
iccsp$iccs[[1]] %>% head
iccsp$data[[1]] %>% ICC
iccsp$data[[2]] %>% ICC
iccsp$data[[3]] %>% ICC
iccsp$data[[4]] %>% ICC
iccsp$data[[5]] %>% ICC
iccsp$data[[6]] %>% ICC
iccsp$data[[7]] %>% ICC
iccsp$data[[8]] %>% ICC
iccsp$data[[9]] %>% ICC
iccsp$data[[10]] %>% ICC
iccsp$data[[11]] %>% ICC
iccsp$data[[14]] %>% ICC
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Variable,year) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
?isSingular
iccsp$data[[1]] %>% head
iccsp$data[[14]] %>% ICC
iccsp$data[[14]] %>% ICC
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip
iccsp$data[[14]] %>% ICC
iccsp$data[[13]] %>% ICC
iccsp$data[[12]] %>% ICC
iccsp$data[[11]] %>% ICC
iccsp$data[[10]] %>% ICC
iccsp$data[[9]] %>% ICC
iccsp$data[[8]] %>% ICC
sc %>%
group_by(year,SubjectID)
sc %>%
group_by(year,SubjectID) %>%
summarise(n())
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(max(n))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(mean(n))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(sd(n))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>% ggplot(aes(n,fill=year))+geom_histogram()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>% ggplot(aes(n,col=year))+geom_histogram()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>% ggplot(aes(n,col=year))+geom_histogram()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n,col=year))+geom_histogram()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n,fill=year))+geom_histogram()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram(aes(fill = year))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram()+facet_grid(~year)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram()+facet_wrap(~year)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram()+facet_wrap(~year)+theme_ang()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram(bins = 10)+facet_wrap(~year)+theme_ang()
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(sd(n))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(quantile(.75))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(quantile(.,.75))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(median())
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(m = median(.))
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year) %>%
summarise(mean())
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n())
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
group_by(year)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
filter(year==2019) %>%
pull(n)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
filter(year==2019) %>%
pull(n) %>% quantile(.75)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
filter(year==2020) %>%
pull(n) %>% quantile(.75)
sc %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram(bins = 20)+facet_wrap(~year)+theme_ang()
sc %>%
filter(Relationship ! ="Self")
sc %>%
filter(Relationship !="Self")
sc %>%
filter(Relationship !="Self") %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
ungroup() %>%
ggplot(aes(n))+geom_histogram(bins = 20)+facet_wrap(~year)+theme_ang()
sc %>%
filter(Relationship !="Self") %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
filter(year==2020) %>%
pull(n) %>% quantile(.75)
sc %>%
filter(Relationship !="Self") %>%
group_by(year,SubjectID) %>%
summarise(n = n()) %>%
filter(year==2019) %>%
pull(n) %>% quantile(.75)
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
mutate(EvaluatorID = 1:n())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n())
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>% summarise(n())
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>% summarise(n = n())
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>% #Comment out to have a column for each judge.
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
mutate(EvaluatorID = 1:n()) %>% #Comment out to have a column for each judge.
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
iccsp$data[[8]] %>% ICC
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),paste0("(",numformat(ICC1k),")"))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip
iccsp$data[[8]] %>% ICC
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n())
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
slice_sample(8)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
slice_sample(n = 8)
iccsp
write.clip(iccsp)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
slice_sample(n = 8) %>% # Comment out to keep all judges. Run this line to limit to select 8 random judges
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
slice_sample(n = 8)
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
slice_sample(n = 8) %>% # Comment out to keep all judges. Run this line to limit to select 8 random judges
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
iccsp$data[[8]] %>% ICC
# Comparing manual vs. psych()
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
mutate(icc = paste(numformat(ICC1),numformat(ICC1k)) %>%
)
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),numformat(ICC1k))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip()
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
slice_sample(n = 8) %>% # Comment out to keep all judges. Run this line to limit to select 8 random judges
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
iccsp$data[[8]] %>% ICC
iccsp$data[[12]] %>% ICC
iccsp$data[[10]] %>% ICC
# Comparing manual vs. psych()
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),numformat(ICC1k))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip()
# Using the psych::ICC
iccsp = sc %>%
filter(Relationship != "Self") %>%
select(SubjectID,EvaluatorID,year,GritPer_scale:avg_perf) %>%
group_by(SubjectID) %>%
slice_sample(n = 2) %>% # Comment out to keep all judges. Run this line to limit to select 8 random judges
gather(Outcome, Value,-year,-SubjectID,-EvaluatorID) %>%
#
group_by(SubjectID,Outcome,year) %>%
mutate(EvaluatorID = 1:n()) %>%
#
group_by(Outcome,year) %>%
nest() %>%
mutate(data = map(data,spread,EvaluatorID,Value),
data = map(data,select,-1)) %>%
mutate(iccs = map(data,ICC),
iccs = map(iccs,"results"),
iccs = map(iccs, select, type,ICC),
iccs = map(iccs, spread,type,ICC))
iccsp$data[[1]] %>% head
iccsp$data[[10]] %>% ICC
# Comparing manual vs. psych()
right_join(iccsp %>% unnest(iccs) %>% select(-data),
iccs %>% mutate(ICC = 1 - ICC) %>% select(-data))
iccsp %>% unnest(iccs) %>%  select(year,Outcome,ICC1,ICC1k) %>%
mutate(icc = paste(numformat(ICC1),numformat(ICC1k))) %>%
select(year,Outcome,icc) %>%
spread(year,icc) %>%
separate(`2019`, c("ICC1","ICC1k"),sep = " ") %>%
separate(`2020`, c("ICC1 ","ICC1k "),sep = " ") %T>%
write.clip()
